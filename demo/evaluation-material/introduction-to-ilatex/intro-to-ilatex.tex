\documentclass[11pt, a4paper]{article}
\input{preamble}

% This package is required for iLaTeX to work!
\usepackage{ilatex}

\begin{document}

\makedoctitle{Introduction to \iLaTeX{}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% START OF CONTENT

\section{What is \iLaTeX{}?}
\iLaTeX{} is a research prototype of a new kind of editor for \LaTeX{} documents.
It is built on top of Visual Studio Code, an open-source code editor.
\iLaTeX{} looks and works like other \LaTeX{} editors such as TeXstudio and Overleaf, but it also offers a new kind of features we call \emph{interactive intermediate representations}---or IIR for short.

IIRs constitute an alternative way to visualise and manipulate certain parts of a \LaTeX{} document than the source code or the generated PDF.
Each IIR is bound to a piece of \emph{visualisable code}, \ie code that can be visualised through an IIR.
IIR are an optional feature of \iLaTeX{}: since the source code of your documents remains accessible at all times, you can also use \iLaTeX{} like a standard \LaTeX{} editor!



\section{\iLaTeX{} in this study}

This study is made of two successive parts that are independent from each other.
At some points in the study, you may be requested or forbidden to use IIRs by the investigator:
\begin{itemize}
    \item If you are \textbf{requested} to use IIRs, you should use IIR as much as possible to perform the task you have been assigned. However, if you believe you cannot accomplish what you want to do with an IIR, or if you think editing the code directly would be faster, you are still allowed to use the code editor.
    \item If you are \textbf{forbidden} to use IIRs, you must use \iLaTeX{} like a standard code editor (you can still use all the regular code editing features provided by Visual Studio Code such as search-and-replace and keyboard shortcuts);
    \item \textbf{Otherwise}, you are free to decide whether you want to use IIRs or not!
\end{itemize}

In case of doubt of whether you can or should use IIR for the current task, please ask the investigator.



\section{General usage of \iLaTeX{}}
\iLaTeX{} will automatically attempt to find all pieces of visualisable code in your document and to create an IIR for every of them.
Visualisable code is detected by the usage of \textbf{special \LaTeX{} commands and environments} that are known to be visualisable by \iLaTeX{}. They will be explained in more details in the next section.

Most of the time, the IIR associated to a PDF element with a \textbf{blue halo} can be displayed by clicking on it.
In some situations however, an IIR may be \textbf{disabled}. In this case, you may encounter the following visuals:

\newpage
\begin{minipage}[t][2.5cm][c]{0.45\textwidth}
    \includegraphics[width=\textwidth]{img/disabled-table.png}
\end{minipage}
\hspace{0.05\textwidth}
\begin{minipage}[t][2.5cm][c]{0.5\textwidth}
    A \textbf{grey halo} means the IIR is disabled: it cannot be clicked.
    It happens (1) every time the document is \textbf{compiling} or (2) when the \textbf{compilation fails}.
\end{minipage}
\begin{minipage}[t][2.5cm][c]{0.45\textwidth}
    \includegraphics[width=\textwidth]{img/syntax-error-in-visualisation.png}
\end{minipage}
\hspace{0.05\textwidth}
\begin{minipage}[t][2.5cm][c]{0.5\textwidth}
    If you edit visualisable code \textbf{while its IIR is displayed}, \iLaTeX{} may (1) fail at \textbf{parsing your code} or (2) \textbf{loose track} of the code.
    In this case, either fix the syntax or recompile \mbox{the document} to force \iLaTeX{} to re-detect every piece of \mbox{visualisable code}.
\end{minipage}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section{List of IIRs available in \iLaTeX{}}

% \newpage
\subsection{Mathematics}

\begin{figure}[hb!]
    \centering
    \includegraphics[width = \textwidth]{img/iir-imaths.png}
    \caption{The IIR of \texttt{imaths} environments. \figstep{1} The editable code of the formula. You can click it to \textbf{modify the code}, and the typeset formula will be \textbf{updated in real time}. \figstep{2} A typeset formula representing the code displayed above. \figstep{3} You can \textbf{point} and \textbf{click} most symbols in the typeset formula to respectively \textbf{highlight} or \textbf{select the piece of code} that generated it.}
    \label{fig:iir-imaths}
\end{figure}

An IIR for mathematics (\autoref{fig:iir-imaths}) can be created with the \texttt{imaths} environment:

\begin{lstlisting}[style=custom-latex]
\begin{imaths}
    x = \alpha x + \beta y + \gamma
\end{imaths}
\end{lstlisting}

It behaves like the \texttt{align*} environment provided by the \texttt{amsmath} package: you can use all the commands accepted by \LaTeX{} in math mode inside, and you can align several formulae by using \verb|&| to align symbols vertically and \verb|\\| to break lines.

% This IIR enables you to edit the code of the formula and \textbf{see the change in the typeset formula in real time}, as well as to \textbf{find} (by pointing) and to \textbf{select} (by clicking) the piece of code related to almost every symbol of the typeset formula.

% \begin{info}
%     When you edit the code of the formula in the IIR, the actual code of your \LaTeX{} document will \textbf{not} be updated until you click outside of the text area or press Enter.
% \end{info}

\begin{warning}
    User-defined commands are not supported (it will compile, but the IIR will not work correctly).
\end{warning}

\begin{example}
    Try to click the formula below and to edit it using the IIR.
    
    \begin{imaths}
        \int_{\mathbb{R}}\left(f-\overline{f}\right)^2 e^H dx \leq C \int \chi_{[-\frac{1}{2},\frac{1}{2}]}|\nabla f|^2 e^H dx +\frac{C}{\gamma^2}  \int \chi_{[-\frac{1}{2},\frac{1}{2}]^c}|\nabla f|^2 e^H dx.
    \end{imaths}
\end{example}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\subsection{Images}

\begin{figure}[h!]
    \centering
    \includegraphics[width = .75\textwidth]{img/iir-iincludegraphics.png}
    \caption{The IIR of \texttt{iincludegraphics} commands. \figstep{1} The expected output of the command. You can \textbf{resize it} by dragging one of the handles around the image. \figstep{2} The area of the image to display. You can \textbf{move it} by dragging it and \textbf{resize it} by dragging one of the handles around the visible area. \figstep{3} You can display or hide the image cropper by clicking this bar. \figstep{4} You can hold the Shift key or uncheck this box to resize the image with a \textbf{non-natural aspect ratio}. If the image has a non-natural aspect ratio when the IIR is opened, the box will be unchecked by default. \figstep{5} You can resize the image to \textbf{restore its natural aspect ratio} by clicking this button.}
    \label{fig:iir-iincludegraphics}
\end{figure}

An IIR for images (\autoref{fig:iir-inicluegraphics}) can be created with the \verb|\iincludegraphics| command (with two \texttt{i}s!):

\begin{lstlisting}[style=custom-latex]
\iincludegraphics[width=\textwidth]{path/to/your/image.png}
\end{lstlisting}

It behaves like the \verb|\includegraphics| command provided by the \texttt{graphicx} package.
Only the \texttt{width}, \texttt{height}, \texttt{trim} and \texttt{clip} options are recognised by \iLaTeX{}.
You can still use all the other options supported by \verb|\includegraphics|, but the IIR will ignore them and may delete them.

% This IIR enables you to \textbf{resize} and to \textbf{crop} the image (\ie only display a certain region of the image). To resize the image (top widget) or the cropped region (bottom widget), click and drag one of the handles displayed around the frame.

\begin{info}
    \iLaTeX{} supports the most common \emph{length macros} like \verb|\textwidth|, so you can freely use them in the options.
    If you are unsure whether a less common length macro is supported and want to use it, please ask the investigator.
\end{info}

% \begin{warning}
%     PDF images are not supported (it will compile, but the IIR will not work correctly).
% \end{warning}

\begin{example}
    Try to click the image below and to edit it using the IIR.
    
    \centering
    \iincludegraphics[width = 0.5\textwidth]{img/bird.jpg}
\end{example}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\subsection{Tables}

\begin{figure}[hb!]
    \centering
    \includegraphics[width = \textwidth]{img/iir-itabular.png}
    \caption{The IIR of \texttt{itabular} environments. \figstep{1} A cell of the table. You can \textbf{edit} its content by double-clicking on it. \figstep{2} The header cell of a column. If \iLaTeX{} was able to parse the type of this column (\eg \texttt{l}, \texttt{c}, \texttt{r}), this cell contains it. You can \textbf{drag it} to \textbf{move the column}. \figstep{3} The header cell of a row. You can \textbf{drag it} to \textbf{move the row}. \figstep{4} You can display a \textbf{contextual menu} by right-clicking any cell of the table. It enables you to \textbf{insert} and \textbf{delete} \textbf{rows and columns}.}
    \label{fig:iir-itabular}
\end{figure}

An IIR for tables (\autoref{fig:iir-itabular}) can be created with the \texttt{itabular} environment:

\begin{lstlisting}[style=custom-latex]
\begin{itabular}{llr}
    Item      & Description & Price \\
    Chocolate & ...         & 2.20  \\
    Baguette  & ...         & 0.90
\end{itabular}
\end{lstlisting}

It behaves like the \texttt{tabular} environment, and expects one mandatory argument (the specification of the columns, such as \texttt{l}, \texttt{r}, etc).

% This IIR enables you to \textbf{edit any cell} (by double-clicking it), to \textbf{insert and delete} rows and columns (via a contextual menu displayed on right click), and to \textbf{move} rows and columns (by dragging and dropping the header cell of the row/column).

% \begin{info}
%     Common formatting commands for tables such as \verb|\hline|, \verb|\toprule|, \verb|\midrule| and \verb|\bottomrule| are not considered as ``cell content'' by this IIR. You can safely use them, and \iLaTeX{} will do its best to ignore them and leave them in place.
% \end{info}

% \begin{warning}
%     Merged cells are not supported (it will compile, but the IIR will not work correctly).
% \end{warning}

\begin{example}
    Try to click the table below and to edit it using the IIR.
    
    \centering
    \begin{itabular}{llr}
        \toprule
        Item  & Description & Price \\
        \midrule
        Chocolate & Delicious treat & 2.20  \\
        Baguette & French classic & 0.90  \\
        Cheese & Another one & 3.00  \\
        Beer & Alcoholic beverage & 4.50  \\
        \bottomrule
    \end{itabular}
\end{example}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\subsection{Grid layouts}

\begin{figure}[h!]
    \centering
    \includegraphics[width = .95\textwidth]{img/iir-gridlayout.png}
    \caption{The IIR of \texttt{gridlayout} environments. \figstep{1} A cell of the layout that is pointed by the mouse. It can be dragged to be moved before or after another cell. \figstep{2} Buttons to insert a new cell. \figstep{3} Button to remove the cell. \figstep{4} Separator between two cells. It can be dragged to resize the adjacent cells. \figstep{5} Separator between two rows. It can be dragged to resize the adjacent rows. \figstep{6} Button to insert a new row at the bottom of the grid.}
    \label{fig:iir-gridlayout}
\end{figure}

An IIR for grid layouts (\autoref{fig:iir-gridlayout}) can be created with the \texttt{gridlayout} environment.
A grid can contain rows (\texttt{row} environments), and a row can contain cells (\texttt{cell} environments).
A cell can contain \textbf{arbitrary content} (text, image, table, etc), but it \textbf{cannot contain} other special commands and environments provided by \iLaTeX{}!

\begin{lstlisting}[style=custom-latex]
% this grid is as wide as the text (\textwidth) and 8cm tall
\begin{gridlayout}{\textwidth}{8cm}
    \begin{row}{0.6}
        \begin{cell}{1}
            % A cell as wide as the row that contains it
        \end{cell}
    \end{row}
    \begin{row}{0.4}
        \begin{cell}{0.33}
            % Bottom-left cell taking 1/3 of the row
        \end{cell}
        \begin{cell}{0.67}
            % Bottom-right cell taking 2/3 of the row
        \end{cell}
    \end{row}
\end{gridlayout}
\end{lstlisting}

Contrary to the other IIRs, this IIR is not a wrapper around an existing command or environment.
Internally, every row and every cell is implemented as a \texttt{minipage}.

The \texttt{grid} environment expects two mandatory arguments: the \textbf{width} and the \textbf{height} of the grid.
The \texttt{row} and \texttt{cell} environments expect one mandatory argument each: the \textbf{relative height} of the row and the \textbf{relative width} of the cell. These relative dimensions are \textbf{unitless numbers between 0 and 1} that must sum to 1 over all the cells of a row and over all the rows of the grid.

% This IIR enables you to \textbf{insert a new row}, a \textbf{new cell}, and to \textbf{delete an existing cell} by clicking the appropriate button (some will appear when you hover a cell). It also enables you to \textbf{resize cells and rows} (by dragging the separator between two of them), as well as to \textbf{move a cell} (by dragging and dropping the cell).

\begin{info}
    In every cell, \iLaTeX{} defines \verb|\cellwidth| and \verb|\rowheight|, two custom length macros relative to the current size of the cell that you can freely use (\eg to make an image have the same width or height than the cell).
\end{info}

% \begin{warning}
%     You should always use at least one row with at least one cell in a \texttt{gridlayout} environment, and you should avoid putting anything outside of a \texttt{cell} environment.
%     Doing so is likely to break the layout, and the IIR will not represent it correctly anymore.
% \end{warning}

\begin{example}
    Try to click the layout below, to understand how it is built, and to edit it using the IIR.

    \begin{gridlayout}{\textwidth}{11cm}
        \begin{row}{0.65}
            \begin{cell}{0.65}
                \includegraphics[width=\cellwidth]{img/bird.jpg}
            \end{cell}
            \begin{cell}{0.05}
                ~
            \end{cell}
            \begin{cell}{0.3}
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus eget mauris sed ligula blandit tristique. Quisque laoreet ac odio hendrerit pretium. Sed hendrerit id elit id lobortis. Aliquam ante eros, euismod et ultricies in, suscipit at lectus. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Cras eu massa congue justo egestas ornare pellentesque in quam.
            \end{cell}
        \end{row}
        \begin{row}{0.05}
            \begin{cell}{1}
                ~ 
            \end{cell}
        \end{row}
        \begin{row}{0.3}
            \begin{cell}{0.3}
                \includegraphics[width=\cellwidth, height=\rowheight, keepaspectratio]{img/cat.jpg}
            \end{cell}
            \begin{cell}{0.05}
                ~
            \end{cell}
            \begin{cell}{0.3}
                \includegraphics[width=\cellwidth, height=\rowheight, keepaspectratio]{img/dolphin.jpg}
            \end{cell}
            \begin{cell}{0.05}
                ~
            \end{cell}
            \begin{cell}{0.3}
                \centering
                \vspace{1em}
                \begin{tabular}{lr}
                    \toprule
                    Animal & Comment \\
                    \midrule
                    Bird & Colorful back \\
                    Cat & Cute look \\
                    Dolphin & Underwater \\
                    \bottomrule
                \end{tabular}
            \end{cell}
        \end{row}
    \end{gridlayout}
\end{example}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\section{Summary of every special commands and environments}
Do not forget to adapt the parameters as needed!

\subsection*{Mathematics}

\commanddesc{Insert a single- or multi-line formula}
\hfill
\lstinline[style=custom-latex]|\begin{imaths} f(x) = 1 \end{imaths}|



\subsection*{Images}

\commanddesc{Insert an image}
\hfill
\lstinline[style=custom-latex]|\iincludegraphics[width=\textwidth]{image.png}|



\subsection*{Tables}

\commanddesc{Insert tabulated data}
\hfill
\lstinline[style=custom-latex]|\begin{itabular}{ll} a & b \\ c & d \end{itabular}|



\subsection*{Grid layouts}
\commanddesc{Insert a grid layout}
\hfill
\lstinline[style=custom-latex]|\begin{gridlayout}{\textwidth}{8cm} ... \end{gridlayout}|

\commanddesc{Insert a row (in a grid layout)}
\hfill
\lstinline[style=custom-latex]|\begin{row}{0.5} ... \end{row}|

\commanddesc{Insert a cell (in a row)}
\hfill
\lstinline[style=custom-latex]|\begin{cell}{0.5} ... \end{cell}|



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% END OF CONTENT

\end{document}
